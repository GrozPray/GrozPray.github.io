<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GrozPray - –í—Ä–µ–º—è –Ω–∞–º–∞–∑–∞ –≤ –ì—Ä–æ–∑–Ω–æ–º</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Amiri:wght@700&family=Open+Sans:wght@400;600&display=swap">
    <style>
        body {
            font-family: 'Open Sans', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
            color: #333;
        }
        
        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        h1 {
            font-family: 'Amiri', serif;
            color: #2c6e49;
        }
        
        .slogan {
            color: #666;
            font-style: italic;
        }
        
        nav {
            display: flex;
            justify-content: space-around;
            background-color: #2c6e49;
            border-radius: 10px;
            padding: 10px;
            margin-bottom: 20px;
        }
        
        nav a {
            color: white;
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 5px;
        }
        
        nav a.active {
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        .card {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .prayer-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .prayer-item {
            background-color: #f9f9f9;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .prayer-name {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
            color: #2c6e49;
        }
        
        .prayer-time {
            font-size: 1.2em;
            font-weight: 600;
        }
        
        .current-prayer {
            background-color: #2c6e49;
            color: white;
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .current-prayer .prayer-name {
            color: white;
        }
        
        footer {
            text-align: center;
            color: #666;
            font-size: 0.9em;
            margin-top: 20px;
        }
        
        @media (min-width: 600px) {
            .prayer-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>GrozPray</h1>
            <p class="slogan">–í–∞—à –ø–æ–º–æ—â–Ω–∏–∫ –≤ –ø–æ–∫–ª–æ–Ω–µ–Ω–∏–∏</p>
        </header>
        
        <nav>
            <a href="index.html" class="active">üïã –ù–∞–º–∞–∑</a>
            <a href="quran.html">üìñ –ö–æ—Ä–∞–Ω</a>
            <a href="dhikr.html">üìø –ó–∏–∫—Ä—ã</a>
        </nav>

        <main>
            <section class="card">
                <h2>‚è≥ –í—Ä–µ–º—è –Ω–∞–º–∞–∑–∞ - –ì—Ä–æ–∑–Ω—ã–π</h2>
                <div class="prayer-grid">
                    <div class="prayer-item" id="fajr-card">
                        <span class="prayer-name">–§–∞–¥–∂—Ä</span>
                        <span class="prayer-time" id="fajr">--:--</span>
                    </div>
                    <div class="prayer-item" id="dhuhr-card">
                        <span class="prayer-name">–ó—É—Ö—Ä</span>
                        <span class="prayer-time" id="dhuhr">--:--</span>
                    </div>
                    <div class="prayer-item" id="asr-card">
                        <span class="prayer-name">–ê—Å—Ä</span>
                        <span class="prayer-time" id="asr">--:--</span>
                    </div>
                    <div class="prayer-item" id="maghrib-card">
                        <span class="prayer-name">–ú–∞–≥—Ä–∏–±</span>
                        <span class="prayer-time" id="maghrib">--:--</span>
                    </div>
                    <div class="prayer-item" id="isha-card">
                        <span class="prayer-name">–ò—à–∞</span>
                        <span class="prayer-time" id="isha">--:--</span>
                    </div>
                </div>
            </section>
        </main>

        <footer>
            <p>¬© 2024 GrozPray | –°–¥–µ–ª–∞–Ω–æ –¥–ª—è –º—É—Å—É–ª—å–º–∞–Ω</p>
        </footer>
    </div>

    <script>
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function requestNotificationPermission() {
            if (!("Notification" in window)) {
                console.log("–≠—Ç–æ—Ç –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è");
                return;
            }
            
            Notification.requestPermission().then(permission => {
                if (permission === "granted") {
                    console.log("–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—É—á–µ–Ω–æ!");
                } else {
                    console.log("–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –ø–æ–ª—É—á–µ–Ω–æ");
                }
            });
        }

        // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ —Å—Ä–∞–∑—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        requestNotificationPermission();

        // –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞–º–∞–∑–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        function loadPrayerTimes() {
            fetch('https://api.aladhan.com/v1/timingsByCity?city=Grozny&country=Russia&method=2')
                .then(response => response.json())
                .then(data => {
                    const timings = data.data.timings;
                    
                    // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –≤—Ä–µ–º—è –Ω–∞–º–∞–∑–æ–≤
                    document.getElementById('fajr').textContent = timings.Fajr;
                    document.getElementById('dhuhr').textContent = timings.Dhuhr;
                    document.getElementById('asr').textContent = timings.Asr;
                    document.getElementById('maghrib').textContent = timings.Maghrib;
                    document.getElementById('isha').textContent = timings.Isha;
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Ä–µ–º—è –Ω–∞–º–∞–∑–æ–≤
                    window.prayerTimes = timings;
                    
                    // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É —Ç–µ–∫—É—â–µ–≥–æ –Ω–∞–º–∞–∑–∞
                    checkCurrentPrayer();
                    setInterval(checkCurrentPrayer, 30000);
                    
                    // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                    setupPrayerNotifications(timings);
                })
                .catch(error => {
                    console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞–º–∞–∑–∞:", error);
                });
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –≤ –º–∏–Ω—É—Ç—ã
        function timeToMinutes(timeStr) {
            const [hours, minutes] = timeStr.split(':').map(Number);
            return hours * 60 + minutes;
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ –Ω–∞–º–∞–∑–∞
        function checkCurrentPrayer() {
            if (!window.prayerTimes) return;
            
            const now = new Date();
            const currentHours = now.getHours();
            const currentMinutes = now.getMinutes();
            const currentTimeInMinutes = currentHours * 60 + currentMinutes;
            
            // –ü–æ–ª—É—á–∞–µ–º –≤—Ä–µ–º—è –Ω–∞–º–∞–∑–æ–≤ –≤ –º–∏–Ω—É—Ç–∞—Ö
            const prayerTimesInMinutes = {
                fajr: timeToMinutes(window.prayerTimes.Fajr),
                dhuhr: timeToMinutes(window.prayerTimes.Dhuhr),
                asr: timeToMinutes(window.prayerTimes.Asr),
                maghrib: timeToMinutes(window.prayerTimes.Maghrib),
                isha: timeToMinutes(window.prayerTimes.Isha)
            };
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ—Ä—è–¥–æ–∫ –Ω–∞–º–∞–∑–æ–≤
            const prayerOrder = ['fajr', 'dhuhr', 'asr', 'maghrib', 'isha'];
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ –ø–æ–¥—Å–≤–µ—Ç–∫–∏
            document.querySelectorAll('.prayer-item').forEach(item => {
                item.classList.remove('current-prayer');
            });
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–µ–∫—É—â–∏–π –Ω–∞–º–∞–∑
            let currentPrayer = null;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–æ–º–µ–∂—É—Ç–∫–∏ –º–µ–∂–¥—É –Ω–∞–º–∞–∑–∞–º–∏
            for (let i = 0; i < prayerOrder.length; i++) {
                const current = prayerOrder[i];
                const next = prayerOrder[(i + 1) % prayerOrder.length];
                
                // –î–ª—è –ò—à–∞ —É—á–∏—Ç—ã–≤–∞–µ–º, —á—Ç–æ —Å–ª–µ–¥—É—é—â–∏–π –Ω–∞–º–∞–∑ - –§–∞–¥–∂—Ä —Å–ª–µ–¥—É—é—â–µ–≥–æ –¥–Ω—è
                if (current === 'isha') {
                    if (currentTimeInMinutes >= prayerTimesInMinutes['isha'] || 
                        currentTimeInMinutes < prayerTimesInMinutes['fajr']) {
                        currentPrayer = 'isha';
                        break;
                    }
                } else {
                    if (currentTimeInMinutes >= prayerTimesInMinutes[current] && 
                        currentTimeInMinutes < prayerTimesInMinutes[next]) {
                        currentPrayer = current;
                        break;
                    }
                }
            }
            
            // –ï—Å–ª–∏ –Ω–∞—à–ª–∏ —Ç–µ–∫—É—â–∏–π –Ω–∞–º–∞–∑ - –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –µ–≥–æ
            if (currentPrayer) {
                document.getElementById(`${currentPrayer}-card`).classList.add('current-prayer');
            }
        }

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –Ω–∞–º–∞–∑–∞—Ö
        function setupPrayerNotifications(timings) {
            const prayerNames = {
                'Fajr': '–§–∞–¥–∂—Ä',
                'Dhuhr': '–ó—É—Ö—Ä',
                'Asr': '–ê—Å—Ä',
                'Maghrib': '–ú–∞–≥—Ä–∏–±',
                'Isha': '–ò—à–∞'
            };
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Ä–µ–º—è –Ω–∞–º–∞–∑–∞ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
            setInterval(() => {
                const now = new Date();
                const currentTime = `${now.getHours()}:${now.getMinutes() < 10 ? '0' + now.getMinutes() : now.getMinutes()}`;
                
                for (const [prayer, time] of Object.entries(timings)) {
                    if (prayerNames[prayer] && time === currentTime) {
                        sendPrayerNotification(prayerNames[prayer], time);
                    }
                }
            }, 60000);
        }

        // –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–∞–º–∞–∑–µ
        function sendPrayerNotification(prayerName, prayerTime) {
            if (Notification.permission === "granted") {
                new Notification('–í—Ä–µ–º—è –Ω–∞–º–∞–∑–∞!', {
                    body: `–°–µ–π—á–∞—Å –≤—Ä–µ–º—è ${prayerName} (${prayerTime}). –ü–æ—Ä–∞ —Å–æ–≤–µ—Ä—à–∏—Ç—å –Ω–∞–º–∞–∑ üôè`,
                    icon: "images/logo.png"
                });
            }
        }

        // –ó–∞–≥—Ä—É–∂–∞–µ–º –≤—Ä–µ–º—è –Ω–∞–º–∞–∑–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('load', loadPrayerTimes);
    </script>
</body>
</html>
